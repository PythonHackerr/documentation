"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9283],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),d=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=d(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=d(n),m=a,g=c["".concat(l,".").concat(m)]||c[m]||p[m]||o;return n?i.createElement(g,r(r({ref:t},u),{},{components:n})):i.createElement(g,r({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var d=2;d<o;d++)r[d]=n[d];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},8215:function(e,t,n){var i=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,a=e.className;return i.createElement("div",{role:"tabpanel",hidden:n,className:a},t)}},1395:function(e,t,n){n.d(t,{Z:function(){return l}});var i=n(7294),a=n(944),o=n(6010),r="tabItem_1uMI",s="tabItemActive_2DSg";var l=function(e){var t,n=e.lazy,l=e.block,d=e.defaultValue,u=e.values,p=e.groupId,c=e.className,m=i.Children.toArray(e.children),g=null!=u?u:m.map((function(e){return{value:e.props.value,label:e.props.label}})),h=null!=d?d:null==(t=m.find((function(e){return e.props.default})))?void 0:t.props.value,f=(0,a.Z)(),k=f.tabGroupChoices,v=f.setTabGroupChoices,w=(0,i.useState)(h),y=w[0],S=w[1],b=[];if(null!=p){var R=k[p];null!=R&&R!==y&&g.some((function(e){return e.value===R}))&&S(R)}var N=function(e){var t=e.currentTarget,n=b.indexOf(t),i=g[n].value;S(i),null!=p&&(v(p,i),setTimeout((function(){var e,n,i,a,o,r,l,d;(e=t.getBoundingClientRect(),n=e.top,i=e.left,a=e.bottom,o=e.right,r=window,l=r.innerHeight,d=r.innerWidth,n>=0&&o<=d&&a<=l&&i>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(s),setTimeout((function(){return t.classList.remove(s)}),2e3))}),150))},T=function(e){var t,n=null;switch(e.key){case"ArrowRight":var i=b.indexOf(e.target)+1;n=b[i]||b[0];break;case"ArrowLeft":var a=b.indexOf(e.target)-1;n=b[a]||b[b.length-1]}null==(t=n)||t.focus()};return i.createElement("div",{className:"tabs-container"},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":l},c)},g.map((function(e){var t=e.value,n=e.label;return i.createElement("li",{role:"tab",tabIndex:y===t?0:-1,"aria-selected":y===t,className:(0,o.Z)("tabs__item",r,{"tabs__item--active":y===t}),key:t,ref:function(e){return b.push(e)},onKeyDown:T,onFocus:N,onClick:N},null!=n?n:t)}))),n?(0,i.cloneElement)(m.filter((function(e){return e.props.value===y}))[0],{className:"margin-vert--md"}):i.createElement("div",{className:"margin-vert--md"},m.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==y})}))))}},9443:function(e,t,n){var i=(0,n(7294).createContext)(void 0);t.Z=i},944:function(e,t,n){var i=n(7294),a=n(9443);t.Z=function(){var e=(0,i.useContext)(a.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e}},3149:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return d},metadata:function(){return u},toc:function(){return p},default:function(){return m}});var i=n(7462),a=n(3366),o=(n(7294),n(3905)),r=n(1395),s=n(8215),l={sidebar_position:10,title:"Building better location permission gathering"},d=void 0,u={unversionedId:"tutorials/building-better-location-permission-gathering",id:"tutorials/building-better-location-permission-gathering",isDocsHomePage:!1,title:"Building better location permission gathering",description:"This tutorial will guide you on using Radar's location permission manager to build a best-in-class user interface for collecting on-device location with the Radar iOS SDK and Android SDK. Achieving high opt-in rates for location permission helps your app deliver more value to users with location-based features.",source:"@site/docs/tutorials/building-better-location-permission-gathering.mdx",sourceDirName:"tutorials",slug:"/tutorials/building-better-location-permission-gathering",permalink:"/documentation/tutorials/building-better-location-permission-gathering",editUrl:"https://github.com/radarlabs/docs/edit/main/docs/tutorials/building-better-location-permission-gathering.mdx",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10,title:"Building better location permission gathering"},sidebar:"defaultSidebar",previous:{title:"Migrating from Google Maps",permalink:"/documentation/tutorials/migrate-from-google-maps"},next:{title:"Waypoint",permalink:"/documentation/waypoint"}},p=[{value:"Languages used",id:"languages-used",children:[]},{value:"Features used",id:"features-used",children:[]},{value:"Steps",id:"steps",children:[{value:"Step 1: Sign up for Radar",id:"step-1-sign-up-for-radar",children:[]},{value:"Step 2: Install the Radar iOS SDK",id:"step-2-install-the-radar-ios-sdk",children:[]},{value:"Step 3: Implement your listeners",id:"step-3-implement-your-listeners",children:[]},{value:"Step 4: Implement navigation logic",id:"step-4-implement-navigation-logic",children:[]}]},{value:"Suggested UI views",id:"suggested-ui-views",children:[{value:"Overview:",id:"overview",children:[]},{value:"Handling Foreground Permission:",id:"handling-foreground-permission",children:[]},{value:"Handling Background Permission:",id:"handling-background-permission",children:[]},{value:"Platform specific states:",id:"platform-specific-states",children:[]},{value:"Conclusion",id:"conclusion",children:[]}]},{value:"Support",id:"support",children:[]}],c={toc:p};function m(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This tutorial will guide you on using Radar's location permission manager to build a best-in-class user interface for collecting on-device location with the Radar ",(0,o.kt)("a",{parentName:"p",href:"/sdk/ios"},"iOS SDK")," and ",(0,o.kt)("a",{parentName:"p",href:"/sdk/android"},"Android SDK"),". Achieving high opt-in rates for location permission helps your app deliver more value to users with location-based features."),(0,o.kt)("p",null,"While iOS and Android expose their own location permission APIs, using them directly can be confusing and clunky. We provide a comprehensive location permission management system that not only wraps the OS features but also offers advanced state management, tracking, and information collection through various channels. This system offers developers a clean and easy interface to streamline their location permission gathering UI flow while leveraging powerful underlying capabilities."),(0,o.kt)("h2",{id:"languages-used"},"Languages used"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Swift"),(0,o.kt)("li",{parentName:"ul"},"Kotlin")),(0,o.kt)("h2",{id:"features-used"},"Features used"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/sdk/ios"},"iOS SDK")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/sdk/android"},"Android SDK"))),(0,o.kt)("h2",{id:"steps"},"Steps"),(0,o.kt)("h3",{id:"step-1-sign-up-for-radar"},"Step 1: Sign up for Radar"),(0,o.kt)("p",null,"If you haven't already, sign up for a Radar account to get your API key, which is required to initialize the SDK. The location-permission functionality is provided without limit, free of charge. You can also create up to 1,000 geofences, track 1,000 users, and make 100,000 API calls per month."),(0,o.kt)("a",{className:"btn btn-large btn-primary",href:"https://radar.com/signup"},"Get API keys"),(0,o.kt)("h3",{id:"step-2-install-the-radar-ios-sdk"},"Step 2: Install the Radar iOS SDK"),(0,o.kt)("h4",{id:"ios"},"iOS"),(0,o.kt)("p",null,"If you're starting from scratch, create a new Xcode project of type Single View App."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"/sdk/ios#install-sdk"},"Install the iOS SDK")," using CocoaPods or SPM (recommended) or by ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/radarlabs/radar-sdk-ios/releases"},"downloading the framework")," and dragging it into your project."),(0,o.kt)("p",null,"Initialize the SDK in your ",(0,o.kt)("inlineCode",{parentName:"p"},"App")," struct with your publishable API key."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},'import SwiftUI\nimport RadarSDK\n\n@main\nstruct ExampleApp: App {\n    init(){\n        Radar.initialize(publishableKey: "prj_test_pk...")\n    }\n    var body: some Scene {\n        WindowGroup {\n            ContentView()\n        }\n    }\n}\n\n')),(0,o.kt)("h4",{id:"android"},"Android"),(0,o.kt)("p",null,"The best way to add the SDK to your project is via Gradle. See the ",(0,o.kt)("a",{parentName:"p",href:"/sdk/android#install-sdk"},"Android SDK installation guide"),"."),(0,o.kt)("p",null,"When your app starts, in application ",(0,o.kt)("inlineCode",{parentName:"p"},"onCreate()"),", initialize the SDK with your publishable API key."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'import io.radar.sdk.Radar\n\nclass MyApplication : Application() {\n\n    override fun onCreate() {\n        super.onCreate()\n\n        val receiver = MyRadarReceiver { context, status ->\n            updateUI(status)\n        }\n\n        Radar.initialize(this, "prj_test_pk...", receiver, Radar.RadarLocationServicesProvider.GOOGLE, true)\n    }\n}\n')),(0,o.kt)("h3",{id:"step-3-implement-your-listeners"},"Step 3: Implement your listeners"),(0,o.kt)("p",null,"Link the SDK to your own state/navigation management logic by implementing ",(0,o.kt)("inlineCode",{parentName:"p"},"RadarDelegates"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"RadarReceiver"),". The radar SDK will send updates on location permission status to your application\u2019s state/navigation management logic via ",(0,o.kt)("inlineCode",{parentName:"p"},"RadarLocationPermissionStatus")," objects. "),(0,o.kt)("p",null,"You can also get up to date ",(0,o.kt)("inlineCode",{parentName:"p"},"RadarLocationPermissionStatus")," objects with ",(0,o.kt)("inlineCode",{parentName:"p"},"Radar.getLocationPermissionStatus()"),"."),(0,o.kt)(r.Z,{groupId:"listeners",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},"import Foundation\nimport CoreLocation\nimport RadarSDK\nclass PermissionManager: NSObject, RadarDelegate, ObservableObject  {\n    \n    @Published var viewState:RadarLocationPermissionState\n    \n    private override init() {\n        viewState = RadarLocationPermissionState.NoPermissionGranted\n        super.init()\n        viewState = Radar.getLocationPermissionStatus().locationPermissionState\n        Radar.setDelegate(self)\n    }\n    \n    func didReceiveEvents(_ events: [RadarEvent], user: RadarUser?) {\n        // do nothing\n    }\n    \n    func didUpdateLocation(_ location: CLLocation, user: RadarUser) {\n        // do nothing\n    }\n    \n    func didUpdateClientLocation(_ location: CLLocation, stopped: Bool, source: RadarLocationSource){\n        // do nothing\n    }\n    \n    func didFail(status: RadarStatus) {\n        // do nothing\n    }\n    \n    func didLog(message: String) {\n        // do nothing\n    }\n    \n    func didUpdateClientLocationPermissionStatus(status: RadarLocationPermissionStatus) {\n        viewState = status.locationPermissionState\n    }\n    static let shared = PermissionManager()\n            \n}\n\n"))),(0,o.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},"class MyRadarReceiver(private val onPermissionUpdated: (Context, RadarLocationPermissionStatus) -> Unit)  : RadarReceiver() {\n\n    override fun onEventsReceived(context: Context, events: Array<RadarEvent>, user: RadarUser?) {\n        // do nothing\n    }\n\n    override fun onLocationUpdated(context: Context, location: Location, user: RadarUser) {\n       // do nothing\n    }\n\n    override fun onClientLocationUpdated(context: Context, location: Location, stopped: Boolean, source: Radar.RadarLocationSource) {\n       // do nothing\n    }\n    override fun onError(context: Context, status: Radar.RadarStatus) {\n        // do nothing\n    }\n\n    override fun onLog(context: Context, message: String) {\n       // do nothing\n    }\n\n    override fun onLocationPermissionStatusUpdated(\n        context: Context,\n        status: RadarLocationPermissionStatus\n    ) {\n        onPermissionUpdated(context, status)\n    }\n}\n")))),(0,o.kt)("h3",{id:"step-4-implement-navigation-logic"},"Step 4: Implement navigation logic"),(0,o.kt)("p",null,"Navigate to the appropriate view via the enum field, ",(0,o.kt)("inlineCode",{parentName:"p"},"locationPermissionState"),", exposed on ",(0,o.kt)("inlineCode",{parentName:"p"},"RadarLocationPermissionStatus"),". Each enumeration will map to a specific view on your application. You may opt to map multiple states to the same view to simplify your own implementation."),(0,o.kt)(r.Z,{groupId:"navigation",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},"import SwiftUI\nimport CoreLocation\nimport RadarSDK\n\nstruct ContentView: View {\n    @ObservedObject var permissionManager = PermissionManager.shared\n    var body: some View {\n        NavigationView {\n            Group {\n                switch permissionManager.viewState {\n                case .NoPermissionGranted:\n                    GetForegroundPermissionStateView()\n                case .ForegroundPermissionPending:\n                    WaitingForForegroundPermissionView()\n                case .ForegroundPermissionRejected:\n                    GoToSettingsViewForegroundDenied()\n                case .ForegroundPermissionGranted:\n                    GetBackgroundPermissionStateView()\n                case .BackgroundPermissionPending:\n                    WaitingForBackgroundPermissionView()\n                case .BackgroundPermissionRejected:\n                    GoToSettingsViewBackgroundDenied()\n                case .BackgroundPermissionGranted:\n                    SuccessView()\n                default:\n                    GoToSettingsView()\n                }\n            }\n        }\n    }\n}\n"))),(0,o.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},"private fun updateUI(state: RadarLocationPermissionStatus){\n    val titleTextView = findViewById<TextView>(R.id.titleTextView)\n    val descriptionTextView = findViewById<TextView>(R.id.descriptionTextView)\n    val myButton = findViewById<Button>(R.id.myButton)\n    when (state.status) {\n        RadarLocationPermissionStatus.LocationPermissionState.NO_PERMISSIONS_GRANTED -> {\n            // handle UI\n        }\n        RadarLocationPermissionStatus.LocationPermissionState.FOREGROUND_LOCATION_PENDING -> {\n            // handle UI\n        }\n        RadarLocationPermissionStatus.LocationPermissionState.FOREGROUND_PERMISSIONS_GRANTED -> {\n            // handle UI\n        }\n        RadarLocationPermissionStatus.LocationPermissionState.BACKGROUND_PERMISSIONS_REJECTED_ONCE -> {\n            // handle UI\n        }\n        RadarLocationPermissionStatus.LocationPermissionState.APPROXIMATE_PERMISSIONS_GRANTED -> {\n            // handle UI\n        }\n        RadarLocationPermissionStatus.LocationPermissionState.BACKGROUND_PERMISSIONS_GRANTED -> {\n            // handle UI\n        }\n        RadarLocationPermissionStatus.LocationPermissionState.FOREGROUND_PERMISSIONS_REJECTED_ONCE -> {\n            // handle UI\n        }\n        RadarLocationPermissionStatus.LocationPermissionState.FOREGROUND_PERMISSIONS_REJECTED -> {\n            // handle UI\n        }\n        RadarLocationPermissionStatus.LocationPermissionState.BACKGROUND_PERMISSIONS_REJECTED -> {\n            // handle UI\n        }\n        else -> {\n            // handle UI\n        }\n    }\n}\n")))),(0,o.kt)("h2",{id:"suggested-ui-views"},"Suggested UI views"),(0,o.kt)("h3",{id:"overview"},"Overview:"),(0,o.kt)("p",null,"Don't approach requesting location permission as a linear UI flow. The state of location permission can change in various ways inside and outside the application. Build a robust UI that gracefully handles any state the app is in. The code in this tutorial presents a minimalistic UI for simplicity. You should enhance the provided template to develop a production-ready UI with additional features and polish."),(0,o.kt)("h3",{id:"handling-foreground-permission"},"Handling Foreground Permission:"),(0,o.kt)("h4",{id:"no_permissions_granted"},(0,o.kt)("strong",{parentName:"h4"},(0,o.kt)("inlineCode",{parentName:"strong"},"NO_PERMISSIONS_GRANTED")),":"),(0,o.kt)("p",null,"If the application doesn't have any permission, explain why you need foreground permission before allowing the user to grant them. Take users to a screen explaining the need for foreground permission, using verbiage similar to the system prompt. "),(0,o.kt)(r.Z,{groupId:"no-permission",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},'struct GetForegroundPermissionStateView: View {\n    var body: some View {\n        VStack {\n            Text("You currently have not granted any locaiton permission. To get foreground location permission, explain why you need them here.")\n            Button("Request Foreground Permission") {\n                Radar.requestForegroundLocationPermission()\n            }\n        }.navigationBarTitle("Get foreground", displayMode: .inline)\n    }\n}\n'))),(0,o.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'<?xml version="1.0" encoding="utf-8"?>\n<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"\n    android:layout_width="match_parent"\n    android:layout_height="match_parent"\n    android:orientation="vertical"\n    android:padding="16dp">\n\n    <TextView\n        android:id="@+id/titleTextView"\n        android:layout_width="match_parent"\n        android:layout_height="wrap_content"\n        android:textSize="24sp"\n        android:textStyle="bold" />\n\n    <TextView\n        android:id="@+id/descriptionTextView"\n        android:layout_width="match_parent"\n        android:layout_height="wrap_content"\n        android:textSize="16sp"\n        android:layout_marginTop="16dp" />\n\n    <Button\n        android:id="@+id/myButton"\n        android:layout_width="wrap_content"\n        android:layout_height="wrap_content"\n        android:text="My Button"\n        android:layout_marginTop="16dp" />\n\n</LinearLayout>\n\nprivate fun updateUI(state: RadarLocationPermissionStatus){\n    val titleTextView = findViewById<TextView>(R.id.titleTextView)\n    val descriptionTextView = findViewById<TextView>(R.id.descriptionTextView)\n    val myButton = findViewById<Button>(R.id.myButton)\n    when (state.status) {\n        RadarLocationPermissionStatus.LocationPermissionState.NO_PERMISSIONS_GRANTED -> {\n            myButton.visibility = View.VISIBLE\n            titleTextView.text = "No Permission"\n            descriptionTextView.text = "You have not granted any locations permission. We need your location for this demo"\n            myButton.text = "Grant foreground Permission"\n            myButton.setOnClickListener {\n                Radar.requestForegroundLocationPermission()\n            }\n        }\n        ...\n    }\n}\n')))),(0,o.kt)("h4",{id:"foreground_location_pending"},(0,o.kt)("strong",{parentName:"h4"},(0,o.kt)("inlineCode",{parentName:"strong"},"FOREGROUND_LOCATION_PENDING")),":"),(0,o.kt)("p",null,"Optionally handle the waiting period while the permission popup is active. "),(0,o.kt)(r.Z,{groupId:"foreground-location-pending",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},'struct WaitingForForegroundPermissionView: View {\n    var body: some View {\n        Text("Waiting for foreground permission")\n        .navigationBarTitle("Waiting", displayMode: .inline)\n    }\n}\n\n'))),(0,o.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'private fun updateUI(state: RadarLocationPermissionStatus){\n    val titleTextView = findViewById<TextView>(R.id.titleTextView)\n    val descriptionTextView = findViewById<TextView>(R.id.descriptionTextView)\n    val myButton = findViewById<Button>(R.id.myButton)\n    when (state.status) {\n        ...\n        RadarLocationPermissionStatus.LocationPermissionState.FOREGROUND_LOCATION_PENDING -> {\n            myButton.visibility = View.GONE\n            titleTextView.text = "Pending Foreground Permission"\n            descriptionTextView.text = "Waiting for permission."\n        }\n        ...\n    }\n}\n')))),(0,o.kt)("h4",{id:"foreground_permissions_rejected"},(0,o.kt)("strong",{parentName:"h4"},(0,o.kt)("inlineCode",{parentName:"strong"},"FOREGROUND_PERMISSIONS_REJECTED")),":"),(0,o.kt)("p",null,"If foreground permission are not granted and essential for your application's core functionality, you should guide the user through a process to enable the required permission in the device settings. Provide clear instructions and a straightforward way for the user to access the appropriate settings screen to grant the necessary foreground permission. "),(0,o.kt)(r.Z,{groupId:"foreground-location-rejected",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},'struct GoToSettingsViewForegroundDenied: View {\n    var body: some View {\n        VStack {\n            Text("Go to settings, you cannot proceed without the  foreground permission")\n            Button("Open Settings") {\n                Radar.openAppSettings()\n            }\n        }.navigationBarTitle("Go to settings", displayMode: .inline)\n    }\n}\n\n'))),(0,o.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'private fun updateUI(state: RadarLocationPermissionStatus){\n    val titleTextView = findViewById<TextView>(R.id.titleTextView)\n    val descriptionTextView = findViewById<TextView>(R.id.descriptionTextView)\n    val myButton = findViewById<Button>(R.id.myButton)\n    when (state.status) {\n        ...\n        RadarLocationPermissionStatus.LocationPermissionState.FOREGROUND_PERMISSIONS_REJECTED -> {\n            myButton.visibility = View.VISIBLE \n            titleTextView.text = "Rejected foreground Permission"\n            descriptionTextView.text = "You have rejected foreground permission for good, please activate it in the settings."\n            myButton.text = "Go to settings to change it"\n            myButton.setOnClickListener {\n                Radar.openAppSettings()\n                }\n            }\n        ...\n    }\n}\n')))),(0,o.kt)("h4",{id:"foreground_permissions_granted"},(0,o.kt)("strong",{parentName:"h4"},(0,o.kt)("inlineCode",{parentName:"strong"},"FOREGROUND_PERMISSIONS_GRANTED")),":"),(0,o.kt)("p",null,"If foreground permission are granted, you have two options for requesting background permission:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Promptly request background permission immediately after obtaining foreground permission. This proactive approach ensures background permission are acquired upfront.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Wait until the user attempts to use a feature or functionality that requires background permission before prompting for them. This just-in-time approach defers the permission request until it's absolutely necessary."))),(0,o.kt)("p",null,"Choose the approach that aligns best with your application's design and user experience goals."),(0,o.kt)("h3",{id:"handling-background-permission"},"Handling Background Permission:"),(0,o.kt)("h4",{id:"foreground_permissions_granted-1"},(0,o.kt)("strong",{parentName:"h4"},(0,o.kt)("inlineCode",{parentName:"strong"},"FOREGROUND_PERMISSIONS_GRANTED")),":"),(0,o.kt)("p",null,"After foreground permission are granted, clearly explain to the user why your app requires background permission before prompting them to grant these permission. Consider using language similar to the operating system's prompts to increase user understanding and buy-in. Keep in mind that an app can only request location background permission if foreground location permission have already been granted. The Radar SDK enforces these prerequisites and will handle the appropriate permission requests accordingly. "),(0,o.kt)(r.Z,{groupId:"foreground-location-granted",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},'struct GetBackgroundPermissionStateView: View {\n    var body: some View {\n        VStack {\n            Text("We have foregorund permission. To get background location permission, explain why you need them here")\n            Button("Request Background Permission") {\n                Radar.requestBackgroundLocationPermission()\n            }\n        }.navigationBarTitle("Get background", displayMode: .inline)\n    }\n}\n\n'))),(0,o.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'private fun updateUI(state: RadarLocationPermissionStatus){\n    val titleTextView = findViewById<TextView>(R.id.titleTextView)\n    val descriptionTextView = findViewById<TextView>(R.id.descriptionTextView)\n    val myButton = findViewById<Button>(R.id.myButton)\n    when (state.status) {\n        ...\n        RadarLocationPermissionStatus.LocationPermissionState.FOREGROUND_PERMISSIONS_GRANTED -> {\n            myButton.visibility = View.VISIBLE \n            titleTextView.text = "Foreground Permission Granted"\n            descriptionTextView.text = "You have granted foreground permission. Please also grant background permission."\n            myButton.text = "Grant Background Permission"\n            myButton.setOnClickListener {\n                Radar.requestBackgroundLocationPermission()\n            }\n        }\n        ...\n    }\n}\n\n')))),(0,o.kt)("h4",{id:"background_location_pending"},(0,o.kt)("strong",{parentName:"h4"},(0,o.kt)("inlineCode",{parentName:"strong"},"BACKGROUND_LOCATION_PENDING")),":"),(0,o.kt)("p",null,"Optionally handle the waiting period while the permission popup is active in iOS. Requesting background permission in android takes the user to the setting screen."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},'struct WaitingForBackgroundPermissionView: View {\n    var body: some View {\n        Text("Waiting for background permission")\n        .navigationBarTitle("Waiting", displayMode: .inline)\n    }\n}\n')),(0,o.kt)("h4",{id:"background_permissions_rejected"},(0,o.kt)("strong",{parentName:"h4"},(0,o.kt)("inlineCode",{parentName:"strong"},"BACKGROUND_PERMISSIONS_REJECTED")),":"),(0,o.kt)("p",null,"If permission are not granted, provide clear information on the limited functionality and a way to redirect users to the settings if needed. Note that you are not allowed to block users who do not grant background permission and you should offer users a way to proceed without background permission."),(0,o.kt)(r.Z,{groupId:"background-location-rejected",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-swift"},'struct GoToSettingsViewBackgroundDenied: View {\n    var body: some View {\n        VStack {\n            Text("Go to settings, you cannot proceed without the background permission")\n            Button("Open Settings") {\n                Radar.openAppSettings()\n            }\n        }.navigationBarTitle("Go to settings", displayMode: .inline)\n    }\n}\n'))),(0,o.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'private fun updateUI(state: RadarLocationPermissionStatus){\n    val titleTextView = findViewById<TextView>(R.id.titleTextView)\n    val descriptionTextView = findViewById<TextView>(R.id.descriptionTextView)\n    val myButton = findViewById<Button>(R.id.myButton)\n    when (state.status) {\n        ...\n        RadarLocationPermissionStatus.LocationPermissionState.BACKGROUND_PERMISSIONS_REJECTED -> {\n            myButton.visibility = View.VISIBLE\n            titleTextView.text = "Rejected background Permission"\n            descriptionTextView.text = "You have rejected background permission for good, please activate it in the settings."\n            myButton.text = "Go to settings to change it"\n            myButton.setOnClickListener {\n                Radar.openAppSettings()\n            }\n        }\n        ...\n    }\n}\n\n')))),(0,o.kt)("h4",{id:"background_permissions_granted"},(0,o.kt)("strong",{parentName:"h4"},(0,o.kt)("inlineCode",{parentName:"strong"},"BACKGROUND_PERMISSIONS_GRANTED")),":"),(0,o.kt)("p",null,"If permission are granted, proceed with location-based functionalities that require background access."),(0,o.kt)("h3",{id:"platform-specific-states"},"Platform specific states:"),(0,o.kt)("h4",{id:"android-1"},"Android:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"FOREGROUND_PERMISSIONS_REJECTED_ONCE")),": The user has rejected to provide foreground permission once. You can still request for foreground permission but you are strongly encouraged to provide additional justification for requesting the permission via the UI."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"APPROXIMATE_PERMISSIONS_GRANTED")),": Instead of granting ",(0,o.kt)("inlineCode",{parentName:"li"},"ACCESS_FINE_LOCATION"),", the user has opted to grant ",(0,o.kt)("inlineCode",{parentName:"li"},"ACCESS_FINE_LOCATION")," instead. You can still request for background permission but your foreground location tracking will be less accurate."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"BACKGROUND_PERMISSIONS_REJECTED_ONCE")),": The user has rejected to provide background permission once. You can still request for background permission but you are strongly encouraged to provide additional justification for requesting the permission via the UI.")),(0,o.kt)("h4",{id:"ios-1"},"iOS"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"PermissionRestricted")),": The operating system or the user has restricted the app from accessing location services. You should prompt the user to manually resolve this state.")),(0,o.kt)("h3",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"Using the Radar SDK can dramatically simplify your implementation of your applications location permission gathering UI. Start implementing best in class locations permission gathering UI with the Radar SDK."),(0,o.kt)("h2",{id:"support"},"Support"),(0,o.kt)("p",null,"Have questions or feedback on this documentation? Let us know! Email us at ",(0,o.kt)("a",{parentName:"p",href:"mailto:support@radar.com"},"support@radar.com"),"."))}m.isMDXComponent=!0},6010:function(e,t,n){function i(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=i(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function a(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=i(e))&&(a&&(a+=" "),a+=t);return a}n.d(t,{Z:function(){return a}})}}]);